---
export const prerender = false

import RootLayout from "../components/layout/rootLayout.astro";
import ScopeViewport from "../components/scope/ScopeViewport.jsx";
import fs from 'node:fs';
import path from 'node:path';

const { searchParams } = Astro.url;
const pageParam = searchParams.get('source');

const DEFAULT_DOC = "/pages/home.json";
let documentToLoad = DEFAULT_DOC;

if (pageParam) {
    const fileName = `${pageParam}.json`;
    const filePath = path.join(process.cwd(), 'public', 'pages', fileName);

    if (fs.existsSync(filePath)) {
        documentToLoad = `/pages/${fileName}`;
    }
}
---

<RootLayout class="bg-[url('/pagebg.svg')] bg-cover bg-center bg-no-repeat items-center justify-center gap-8 sm:p-8">

    <ScopeViewport document={documentToLoad} client:load/>

</RootLayout>